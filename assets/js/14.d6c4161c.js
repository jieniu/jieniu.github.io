(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{369:function(t,s,a){"use strict";a.r(s);var i=a(45),e=Object(i.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"二分类评估-从混淆矩阵说起"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二分类评估-从混淆矩阵说起"}},[t._v("#")]),t._v(" 二分类评估，从混淆矩阵说起")]),t._v(" "),a("p",[t._v("在"),a("RouterLink",{attrs:{to:"/AI/cross-validation.html"}},[t._v("《理解交叉验证》")]),t._v("一文中，我们谈到了使用 AUC 来对比不同模型的好坏，那么 AUC 是什么？它是如何衡量一个模型的好坏的呢？除了 AUC 以外，还有其他评估手段吗？本文我们就来探讨下这几个问题。")],1),t._v(" "),a("h2",{attrs:{id:"混淆矩阵"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#混淆矩阵"}},[t._v("#")]),t._v(" 混淆矩阵")]),t._v(" "),a("p",[t._v("要了解 AUC，我们需要从另外一个概念——混淆矩阵（Confusion Matrix）说起，混淆矩阵是一个 2 维方阵，它主要用于评估二分类问题（例如：预测患或未患心脏病、股票涨或跌等这种只有两类情况的问题）的好坏。你可能会问多分类问题怎么办？实际上，多分类问题依然可以转换为二分类问题进行处理。下图是一个用于评判是否患有心脏病的混淆矩阵：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/jieniu/articles/blob/master/docs/.vuepress/public/cm1.png?raw=true",alt:"cm1"}})]),t._v(" "),a("p",[t._v("纵向看混淆矩阵，它体现了真实情况下，患病和未患病的人数，上图中，真实患心脏病的人数为 True Positive + False Negative，未患心脏病的人数为 False Positive + True Negative；类似的，横向看混淆矩阵，它体现了模型预测出来患心脏病的人数为 True Positive + False Positive，而预测未患心脏病的人数为 False Negative + True Negative。")]),t._v(" "),a("p",[t._v("两个方向一起看，预测患病且实际也患病，我们称它为真阳性 (True Positive)，预测未患病且实际也未患病，被称为真阴性 (True Negative)，这两个区域是模型预测正确的部分；模型预测错误也分两种情况，假阳性 (False Positive) 表示预测患病，但实际却未患病，假阴性 (False Negative) 表示预测未患病，但实际却患了病的情况。")]),t._v(" "),a("p",[t._v("概念有点多，但并不难记，可以看到，这些名词都是围绕着预测来命名的——预测患病时被称为「True/False Positive」，预测未患病时被称为 「True/False Negative」。")]),t._v(" "),a("p",[t._v("上图中，模型预测正确的部分用绿色填充，它所占的比例又被称为准确率 (Accuracy)：")]),t._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("A")]),a("mi",[t._v("c")]),a("mi",[t._v("c")]),a("mi",[t._v("u")]),a("mi",[t._v("r")]),a("mi",[t._v("a")]),a("mi",[t._v("c")]),a("mi",[t._v("y")]),a("mo",[t._v("=")]),a("mfrac",[a("mrow",[a("mi",[t._v("T")]),a("mi",[t._v("P")]),a("mo",[t._v("+")]),a("mi",[t._v("T")]),a("mi",[t._v("N")])],1),a("mrow",[a("mi",[t._v("T")]),a("mi",[t._v("P")]),a("mo",[t._v("+")]),a("mi",[t._v("T")]),a("mi",[t._v("N")]),a("mo",[t._v("+")]),a("mi",[t._v("F")]),a("mi",[t._v("P")]),a("mo",[t._v("+")]),a("mi",[t._v("F")]),a("mi",[t._v("N")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("Accuracy = \\frac {TP + TN} {TP + TN + FP + FN}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.36033em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.1296600000000003em","vertical-align":"-0.7693300000000001em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathit"},[t._v("A")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("u")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),t._v(" "),a("p",[t._v("单靠准确率这一项，并不足以评估模型的好坏，例如下面这种情况，虽然准确率可以达到 80%，但在实际患病的人群中，该模型的预测成功率只有 50%，很明显它不是一个好模型。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th",[t._v("患心脏病")]),t._v(" "),a("th",[t._v("未患心脏病")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("患心脏病")]),t._v(" "),a("td",[t._v("10")]),t._v(" "),a("td",[t._v("10")])]),t._v(" "),a("tr",[a("td",[t._v("未患心脏病")]),t._v(" "),a("td",[t._v("10")]),t._v(" "),a("td",[t._v("70")])])])]),t._v(" "),a("h2",{attrs:{id:"sensitivity-和-specificity"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sensitivity-和-specificity"}},[t._v("#")]),t._v(" Sensitivity 和 Specificity")]),t._v(" "),a("p",[t._v('所以，我们需要引入更多的衡量指标，Sensitivity (或 Recall) 表示实际患者中，预测患病成功的概率，同时 Sensitivity 这个词也有"过敏"的意思，和患病对应，这样关联起来比较好记：')]),t._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("S")]),a("mi",[t._v("e")]),a("mi",[t._v("n")]),a("mi",[t._v("s")]),a("mi",[t._v("i")]),a("mi",[t._v("t")]),a("mi",[t._v("i")]),a("mi",[t._v("v")]),a("mi",[t._v("i")]),a("mi",[t._v("t")]),a("mi",[t._v("y")]),a("mo",[t._v("=")]),a("mfrac",[a("mrow",[a("mi",[t._v("T")]),a("mi",[t._v("P")])],1),a("mrow",[a("mi",[t._v("T")]),a("mi",[t._v("P")]),a("mo",[t._v("+")]),a("mi",[t._v("F")]),a("mi",[t._v("N")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("Sensitivity = \\frac{TP}{TP+FN}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.36033em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.1296600000000003em","vertical-align":"-0.7693300000000001em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"mord mathit"},[t._v("n")]),a("span",{staticClass:"mord mathit"},[t._v("s")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("t")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("v")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("t")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),t._v(" "),a("p",[t._v("既然有衡量患病（正样例）的指标，那肯定也有衡量未患病（负样例）的指标，Specificity 就是用来表示实际未患病的人群中，预测未患病成功的概率，即")]),t._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("S")]),a("mi",[t._v("p")]),a("mi",[t._v("e")]),a("mi",[t._v("c")]),a("mi",[t._v("i")]),a("mi",[t._v("f")]),a("mi",[t._v("i")]),a("mi",[t._v("c")]),a("mi",[t._v("i")]),a("mi",[t._v("t")]),a("mi",[t._v("y")]),a("mo",[t._v("=")]),a("mfrac",[a("mrow",[a("mi",[t._v("T")]),a("mi",[t._v("N")])],1),a("mrow",[a("mi",[t._v("T")]),a("mi",[t._v("N")]),a("mo",[t._v("+")]),a("mi",[t._v("F")]),a("mi",[t._v("P")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("Specificity = \\frac{TN}{TN+FP}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.36033em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.1296600000000003em","vertical-align":"-0.7693300000000001em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"mord mathit"},[t._v("p")]),a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("t")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[t._v("N")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),t._v(" "),a("p",[t._v('Specificity 这个词有"免疫"的意思，能和未患病相关联，所以也很好记。')]),t._v(" "),a("p",[t._v("这两个指标的出现，能更好的帮你比较模型间的差异，并在其中做出取舍。例如当两个模型的 Accuracy 相近时，如果你更看重于预测患病的效果，你应该选 Sensitivity 值较高的；相反，如果你更看重于预测未患病的效果，你就应该选择 Specificity 较高的。")]),t._v(" "),a("h2",{attrs:{id:"roc-曲线、auc-和-f1-score"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#roc-曲线、auc-和-f1-score"}},[t._v("#")]),t._v(" ROC 曲线、AUC 和 F1 Score")]),t._v(" "),a("p",[t._v("更进一步，我们还可以通过将这些指标图形化，以获得更直观的评估结果，ROC (Receiver Operating Characteristic) 曲线就是其中常用的一种。")]),t._v(" "),a("p",[t._v('我们知道，分类模型（例如"逻辑回归”）的结果是一个大于 0 且小于 1 的概率，此时我们还需要一个阈值，才能界定是否患病，通常我们把阈值设为 0.5，这样当结果大于 0.5 时可判定为患病，否则判定为未患病。')]),t._v(" "),a("p",[t._v("而阈值可以取 0 到 1 之间的任意一个值，对每一个阈值，都有一个混淆矩阵与之对应，有了混淆矩阵，我们就可以求出一对 Sensitivity 和 Specificity，通过这两个数，我们就可以在一个以 1-Specificity 为横坐标，Sensitivity 为纵坐标的坐标系上画一个点，把所有可能的阈值所产出的点连起来，就是 ROC 曲线。")]),t._v(" "),a("p",[t._v("下面我们来看一个具体的例子，假设我们对老鼠做研究，希望通过老鼠的体重来预测其患心脏病的概率，我们采用逻辑回归算法来建模，下图是预测结果，图中有 10 个老鼠样本点，其中红色点代表实际健康的老鼠，蓝色点代表实际患病的老鼠，这些点用一条逻辑回归曲线拟合，图中还有一条 P=0.5 的直线用来表示阈值为 0.5，可以看出，高于 P=0.5 的 5 只老鼠被预测为患病，而其他 5 只老鼠被预测为健康，预测成功率（Accuracy）为 80%：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/jieniu/articles/blob/master/docs/.vuepress/public/image-20190430205818287.png?raw=true",alt:""}})]),t._v(" "),a("p",[t._v("下面我们通过以上数据，来画一条 ROC 曲线。首先取阈值为 1，此时所有的老鼠都被预测为未患病，根据样本真实患病情况，我们可以得到如下混淆矩阵")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/jieniu/articles/blob/master/docs/.vuepress/public/lr_cm.png?raw=true",alt:""}})]),t._v(" "),a("p",[t._v("根据上述混淆矩阵，我们就可以算出一组 Sensitivity 和 Specificity 的值。接着我们不断调整阈值，以获得所有的 Sensitivity 和 Specificity 对，因为这里我们的样本点较少，所以让阈值根据样本点来采样即可，依然用横线表示阈值，则所有阈值的采样情况如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/jieniu/articles/blob/master/docs/.vuepress/public/image-20190430224415492.png?raw=true",alt:""}})]),t._v(" "),a("p",[t._v("我们把这些阈值对应的混淆矩阵都列出来：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/jieniu/articles/blob/master/docs/.vuepress/public/all_cm.png?raw=true",alt:""}})]),t._v(" "),a("p",[t._v("然后，计算这些混淆矩阵对应的 Sensitivity 和 1-Specificity：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Threshold")]),t._v(" "),a("th",[t._v("Sensitivity")]),t._v(" "),a("th",[t._v("1- Specificity")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("1")]),t._v(" "),a("td",[t._v("0")]),t._v(" "),a("td",[t._v("0")])]),t._v(" "),a("tr",[a("td",[t._v("0.99")]),t._v(" "),a("td",[t._v("0.2")]),t._v(" "),a("td",[t._v("0")])]),t._v(" "),a("tr",[a("td",[t._v("0.97")]),t._v(" "),a("td",[t._v("0.4")]),t._v(" "),a("td",[t._v("0")])]),t._v(" "),a("tr",[a("td",[t._v("0.94")]),t._v(" "),a("td",[t._v("0.4")]),t._v(" "),a("td",[t._v("0.2")])]),t._v(" "),a("tr",[a("td",[t._v("0.90")]),t._v(" "),a("td",[t._v("0.6")]),t._v(" "),a("td",[t._v("0.2")])]),t._v(" "),a("tr",[a("td",[t._v("0.71")]),t._v(" "),a("td",[t._v("0.8")]),t._v(" "),a("td",[t._v("0.2")])]),t._v(" "),a("tr",[a("td",[t._v("0.09")]),t._v(" "),a("td",[t._v("0.8")]),t._v(" "),a("td",[t._v("0.4")])]),t._v(" "),a("tr",[a("td",[t._v("0.043")]),t._v(" "),a("td",[t._v("1.0")]),t._v(" "),a("td",[t._v("0.4")])]),t._v(" "),a("tr",[a("td",[t._v("0.0061")]),t._v(" "),a("td",[t._v("1.0")]),t._v(" "),a("td",[t._v("0.6")])]),t._v(" "),a("tr",[a("td",[t._v("0.0003")]),t._v(" "),a("td",[t._v("1.0")]),t._v(" "),a("td",[t._v("0.8")])]),t._v(" "),a("tr",[a("td",[t._v("0")]),t._v(" "),a("td",[t._v("1.0")]),t._v(" "),a("td",[t._v("1.0")])])])]),t._v(" "),a("p",[t._v("根据该表格，以 1-Specificity 为横轴，Sensitivity 为纵轴作图，通常，在画 ROC 曲线时，我们把 1-Specificity 对应的坐标轴记为 FPR (False Positive Rate)，把 Sensitivity 对应的坐标轴记为  TPR (True Positive Rate)，如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/jieniu/articles/blob/master/docs/.vuepress/public/image-20190430234946551.png?raw=true",alt:""}})]),t._v(" "),a("p",[t._v("ROC 曲线有以下特点：")]),t._v(" "),a("ol",[a("li",[t._v("从 (0, 0) 点到 (1,1) 点的对角线上的每个点，意味着在患者中，预测患病成功的概率（TPR），与未患病者中，预测未患病失败的概率（FPR）相等，对于模型来说，TPR 越大越好，FPR 越小越好，所以我们需要尽可能的使 ROC 曲线沿左上角方向远离该对角线。")]),t._v(" "),a("li",[t._v("ROC 曲线还可以帮助我们选择合适的阈值，即 TPR 相同的情况下，ROC 上的点越靠左，效果越好，因为越靠左，意味着 FPR 越小。")])]),t._v(" "),a("p",[t._v("根据 ROC 曲线的第 1 个特点：「曲线越靠近左上角，模型的效果越好」，意味着一个更好模型，其曲线下方的面积更大，我们把 ROC 曲线下方的面积称为 AUC (Area Under Curve)，有了这个概念后，只需一个数值就可以衡量模型的好坏了，上面示例模型的 AUC 如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/jieniu/articles/blob/master/docs/.vuepress/public/image-20190501230646710.png?raw=true",alt:""}})]),t._v(" "),a("p",[t._v("通常情况下我们都使用 AUC 来评估模型，既然是”通常”，那肯定就有例外：当患病率 (或正样本占比)  非常小时，Ture Negative 就会非常大，这个值就会使影响 FPR，使 FPR 较小，为了避免这种影响，我们可以将 FPR 用另一个指标代替：Precision")]),t._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("P")]),a("mi",[t._v("r")]),a("mi",[t._v("e")]),a("mi",[t._v("c")]),a("mi",[t._v("i")]),a("mi",[t._v("s")]),a("mi",[t._v("i")]),a("mi",[t._v("o")]),a("mi",[t._v("n")]),a("mo",[t._v("=")]),a("mfrac",[a("mrow",[a("mi",[t._v("T")]),a("mi",[t._v("P")])],1),a("mrow",[a("mi",[t._v("T")]),a("mi",[t._v("P")]),a("mo",[t._v("+")]),a("mi",[t._v("F")]),a("mi",[t._v("P")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("Precision = \\frac{TP}{TP+FP}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.36033em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.1296600000000003em","vertical-align":"-0.7693300000000001em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("s")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit"},[t._v("n")]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("T")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),t._v(" "),a("p",[t._v("Precision 的含义是预测患病的样本中，实际也患病的比例；这样，将 Precision 和 Sensitivity 结合起来，会让我们更专注于患病 (正样本) 的预测效果，而机器学习中的另一个效果指标："),a("strong",[t._v("F1 Score")]),t._v("，就是专门负责这件事儿的")]),t._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[t._v("F")]),a("mn",[t._v("1")]),a("mtext"),a("mi",[t._v("S")]),a("mi",[t._v("c")]),a("mi",[t._v("o")]),a("mi",[t._v("r")]),a("mi",[t._v("e")]),a("mo",[t._v("=")]),a("mn",[t._v("2")]),a("mo",[t._v("×")]),a("mfrac",[a("mrow",[a("mi",[t._v("P")]),a("mi",[t._v("r")]),a("mi",[t._v("e")]),a("mi",[t._v("c")]),a("mi",[t._v("i")]),a("mi",[t._v("s")]),a("mi",[t._v("i")]),a("mi",[t._v("o")]),a("mi",[t._v("n")]),a("mo",[t._v("×")]),a("mi",[t._v("R")]),a("mi",[t._v("e")]),a("mi",[t._v("c")]),a("mi",[t._v("a")]),a("mi",[t._v("l")]),a("mi",[t._v("l")])],1),a("mrow",[a("mi",[t._v("P")]),a("mi",[t._v("r")]),a("mi",[t._v("e")]),a("mi",[t._v("c")]),a("mi",[t._v("i")]),a("mi",[t._v("s")]),a("mi",[t._v("i")]),a("mi",[t._v("o")]),a("mi",[t._v("n")]),a("mo",[t._v("+")]),a("mi",[t._v("R")]),a("mi",[t._v("e")]),a("mi",[t._v("c")]),a("mi",[t._v("a")]),a("mi",[t._v("l")]),a("mi",[t._v("l")])],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("F1~Score = 2\\times \\frac{Precision\\times Recall}{Precision + Recall}\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.37144em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.14077em","vertical-align":"-0.7693300000000001em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")]),a("span",{staticClass:"mord mathrm"},[t._v("1")]),a("span",{staticClass:"mord mspace"}),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.05764em"}},[t._v("S")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"mrel"},[t._v("=")]),a("span",{staticClass:"mord mathrm"},[t._v("2")]),a("span",{staticClass:"mbin"},[t._v("×")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("s")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit"},[t._v("n")]),a("span",{staticClass:"mbin"},[t._v("+")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.00773em"}},[t._v("R")]),a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[t._v("P")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.02778em"}},[t._v("r")]),a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("s")]),a("span",{staticClass:"mord mathit"},[t._v("i")]),a("span",{staticClass:"mord mathit"},[t._v("o")]),a("span",{staticClass:"mord mathit"},[t._v("n")]),a("span",{staticClass:"mbin"},[t._v("×")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.00773em"}},[t._v("R")]),a("span",{staticClass:"mord mathit"},[t._v("e")]),a("span",{staticClass:"mord mathit"},[t._v("c")]),a("span",{staticClass:"mord mathit"},[t._v("a")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.01968em"}},[t._v("l")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[t._v("​")])]),t._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])])]),t._v(" "),a("p",[t._v("上面的公式中，Recall 等价于 Sensitivity，和 AUC 一样，两个模型互相比较，F1 Score 越大者，预测效果越好，而且 F1 Score 能更好的衡量正样本的预测效果。")]),t._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("p",[t._v("本文通过一个医学例子——是否患心脏病——来讲述什么是混淆矩阵、ROC 曲线、AUC 及 F1 Score，其中，我们还一起学习了 ROC 曲线是如何画出来的，最后，我们还谈到了 AUC 和 F1 Score 以及它们之间细微的差别。")]),t._v(" "),a("p",[t._v("需要注意的是，二分类评估并不限于对患病及未患病这两种情况的分类，考虑到通用性，你完全可以将本文中的患心脏病替换为正样本、把未患心脏病替换为负样本。")])])}),[],!1,null,null,null);s.default=e.exports}}]);